<!DOCTYPE html>

<html>

<head>
	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-68403134-2"></script>
	<script>
		window.dataLayer = window.dataLayer || [];

		function gtag() {
			dataLayer.push(arguments);
		}
		gtag('js', new Date());

		gtag('config', 'UA-68403134-2');
	</script>

	<meta charset="utf-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

	<!-- Latest compiled and minified CSS -->

	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">

	<!-- jQuery library -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha384-tsQFqpEReu7ZLhBV2VZlAu7zcOV+rXbYlF2cqB8txI/8aZajjp4Bqd+V6D5IgvKT" crossorigin="anonymous"></script>

	<!-- Popper JS -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>

	<!-- Latest compiled JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>

	<link rel="stylesheet" href="style.css">
	<script>
		window.addEventListener("hashchange", function() {
			scrollBy(0, -60)
		})
	</script>

	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/default.min.css">
	<script src="../highlight.pack.js"></script>
	<script>
		hljs.initHighlightingOnLoad();
	</script>

	<title>
		CS503: Operating Systems, Spring 22 -- Xinu setup
	</title>

</head>

<body>



	<!-- Navigation -->
	<nav class="navbar navbar-expand-lg navbar-dark bg-primary sticky-top ">
		<div class="container">
			<a class="navbar-brand" href="#overview">CS503: Operating Systems, Spring 22</a>
			<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse" id="navbarResponsive">
				<ul class="navbar-nav ml-auto">
					<!--li class="nav-item active">
              <a class="nav-link" href="#overview">Overview
                <span class="sr-only">(current)</span>
              </a>
            </li-->
				</ul>
			</div>
		</div>
	</nav>

	<p>

		<!-- =============================================================================  -->
		<div class="container">
			<h1 id="overview">
				Lab 0: Getting Acquainted with XINU [20 pts]
			</h1>


			<p>

				<div class="alert alert-dismissible alert-info">
					<strong>Due date:</strong> 01/26/2022 (Wed.), 11:59 PM
				</div>

			</p>

			<p>
				The objectives of this introductory lab are to familiarize you with the steps
				involved in compiling and running XINU in our lab and to understand the XINU system call interface.
			</p>

			<div class="alert alert-dismissible alert-success">
				<strong>Reminder:</strong> You are required to commit and push your changes frequently
				(e.g., at least every couple of hours of work or more often) to the GitHub Classroom git repository assigned to you.
				This will be important to help you recover from bad changes,
				communicate with your TA, and enforce the course policies. Failure
				to comply with this requirement in any assignment will result in
				lost points or a zero grade in the assignment.
			</div>

			<h2>1. Readings</h2>
			<p>
				Read the following documents and follow the instructions in the setup guide:
				<ol>
					<li><a href="./xinu-setup.html">XINU setup</a></li>
					<li>Chapters 1 and 2 from the XINU textbook.</li>
				</ol>



				<h2>2. Inspect XINU's first process [5 pts]</h2>

				<p>
					The code for the first user process that is created by XINU is located in <code>system/main.c</code>. By default it creates a single process that implements the XINU shell. Furthermore, it repeatedly creates a new shell after each shell
					process returns.
				</p>

				<p>
					Processes in XINU are created using the <code>create</code> system call which does the following: (1) creates all necessary control structures for the new process and (2) initializes the process stack for the new process.
					The <code>create</code> system call returns the process identifier (PID) of the new process. The code for the <code>create</code> system call is located in <code>system/create.c</code>. Open <code>system/create.c</code> and familiarize
					does.
				</p>

				<p>
					Modify <code>system/main.c</code> so that it prints the process ID of each new shell process by producing messages with the following format: "New shell PID = %d\n". Ensure the message is printed before the shell process
					starts running by invoking the kprintf() kernel function before the new process is resumed.
				</p>



				<h2>3. Create a new system call [5 pts]</h2>

				<p>
					The XINU system calls are declared in the file <code>include/prototypes.h</code>. Create a system call named "hello" that receives no argument and always returns success (<code>retval = 1</code> ). Implement the
					new system call inside a new file <code>system/hello.c</code>. The new system call should print the following message using the <code>kprintf</code> kernel function: "Hello system call invoked\n"
				</p>

				<p>
					<div class="alert alert-dismissible alert-success">
						Remember to call <code class="bash"> $ make rebuild</code> when adding new files to the Xinu source tree.
					</div>
				</p>



				<h2>4. Inspect the shell code and implement a new shell command [5 pts]</h2>

				<p>
					The shell code is in the directory <code>shell/</code>. The <code>shell/shell.c</code> file contains the structure <code>cmdtab</code> with all the commands recognized by the shell that the user can invoke. Each field specifying a command
					contains the command name and the command function, in addition, it contains a <code>bool</code> field that specifies whether the command is built-in or not.
				</p>


				<p>
					Create a new shell command called "hello". It should be implemented with a new function, <code>xsh_hello</code>, that you should define in a new file: <code>shell/xsh_hello.c</code>. Ensure that the new function is declared in the header
					file <code>include/shprototypes.h</code>. The definition of the function should call the <code>hello</code> system call that you implemented in 3.
				</p>

				<p>
					After implementing this command, when the user types the "hello" command in the Xinu shell, it should cause the kernel to print the message: "Hello system call invoked\n".
				</p>

				<h2>5. Memory layout [5 pts]</h2>

				<p>
					Using the same procedure described in 4, create a new command called "layout", in a new file <code>shell/xsh_layout.c</code>, and implement it in a function called <code>xsh_layout</code>. When creating the command ensure that it is not a
					built-in
					command (which would create a new process <strike>function</strike> instead of executing a function).
				</p>

				<p>The new command should declare three variables: (1) an initialized global variable "int layout_var_init = 1;", (2) an uninitialized global variable "int layout_var_uninit;" and (3) a stack variable "int layout_stack;". In addition, it
					should print the <b>addresses</b> of these variables using the <code>printf</code> function. Furthermore, the command should print the address of the <code>xsh_layout</code> function.
				</p>

				<p>
					Please use "%x" (not "%p") to print addresses with printf, since "%p" is not supported by the Xinu implementation.
				</p>


				<h2>Turn-in your work</h2>

				<p>Reminder: <em>GitHub Classroom</em> <strong>is not</strong> used to submit work,
					you must use Purdue's turn-in system and only your last submission will be saved. Hence, make sure your last submission is made before the project deadline.</p>


				1. Required output format:
				<ul>
					<li>
						For labs that ask to <strong>print messages</strong>
						using kprintf() or printf(), use must use
						conditional compilation (e.g., C preprocessor directives #if and #define)
						with the macro XTEST appropriately set to 1 or 0 (in include/process.h).
						XTEST will toggle between
						print and no print and will be critical for grading. I.e., XTEST==1: print assignment messages,
						XTEST==0: do not print assignment messages.
					</li>
					<li>
						For your own <strong>debug messages</strong>, do the same but use the macro XDEBUG. I.e., XDEBUG==1: print your debug messages, XDEBUG==0: do not print your debug messages.
					</li>
				</ul>


				<p>
					2. Before submitting your work, make sure to double-check
					the TA Notes in Piazza
					to ensure that additional requirements and instructions have been followed.
				</p>

				<p>
					3. Please make sure to disable all debugging output before submitting your code.
				</p>

				<p>
					4. Electronic turn-in instructions:
				</p>
				<ol>
					<li>
						Go to the xinu-cs503-spring2022/compile directory and run <code class="bash"> make clean</code>.
					</li>

					<li>
						Go to the directory of which your xinu-cs503-spring2022 directory
						is a subdirectory.
						E.g., if /homes/bob/xinu-cs503-spring2022 is your directory
						structure, go to /homes/bob.
						(Note: please do not rename xinu-cs503-spring2022 or any of its subdirectories.)
					</li>

					<li>Type the following command to turn in the files:
						<pre><code class="bash">turnin -c cs503 -p lab0 xinu-cs503-spring2022
	</code></pre>
					</li>

					<li> List and check the submitted files with the following command:
						<pre><code class="bash"> turnin -c cs503 -p lab0 -v
	</pre></code>
					</li>
				</ol>





				<!--<hr><a href="../index.html">Back to the CS503 web page</a><br>-->




				<!-- Footer -->
				<footer id="footer">
					<div class="container text-right">
						<div class="col-lg-12">
							<p>
								<small class="text-muted text-right">Last update:</small>
						</div>
					</div>
				</footer>
</body>

</html>
